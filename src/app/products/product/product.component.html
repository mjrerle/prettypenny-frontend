<div *ngIf="isLoading" class="loaderOverlay">
  <div class="loader">Loading...</div>
</div>


<div class="columns">
  <div class="column is-two-thirds">
    <div class="card">
      <header class="card-header">
        <p class="card-header-title">
          {{ product ? product?.productName : 'loading' }}
        </p>
        <span>
          <p class="text-secondary strikethrough">{{ product ? (product.price | currency) : 'loading' }}</p>
          <strong class="text-danger">{{ product ? (product.salePrice | currency) : 'loading' }}</strong>
        </span>
      </header>
      <div class="card-image">
        <figure class="image is-4by3">
          <img [src]="product ? product.imageUrl : 'http://via.placeholder.com/500x500'" [alt]="product?.productName" />
        </figure>
      </div>
    </div>
  </div>
  <div class="column is-one-third">
    <a class="button is-light" routerLink="/products">
      <span class="icon">
        <i class="fas fa-arrow-left"></i>
      </span>&nbsp; Back to Products
    </a>

    <hr>
    <span class="text-success" *ngIf="pretty">Amount left: {{ product.interestThreshold }}</span>
    <app-number-input [(val)]="quantity" (valAdd)="onValAdd()" (valSub)="onValSub()" [minDisabled]="quantity === 1">
    </app-number-input>
    <div *ngIf="pretty; else penny">
      <button class="card-footer-item btn btn-primary" [disabled]="!loggedIn" style="cursor: pointer;"
        (click)="addToCart(product)">
        Add to Cart
      </button>
    </div>
    <ng-template #penny>
      <button class="card-footer-item btn btn-secondary" [disabled]="!loggedIn" style="cursor: pointer;"
        (click)="addToCart(product)">
        Add to Interests
      </button>
    </ng-template>

    <hr>

    <div class="card-content">
      <div class="content">
        <div *ngIf="pretty; else pennyDescription">
          {{ product ? product.description : 'loading' }}
        </div>
        <ng-template #pennyDescription>

          <p>
            <ngb-progressbar type="warning" [value]="percentage" height=".5rem">.</ngb-progressbar>
          </p>
          <div class="row">
            <div class="align-self-start">
              <p class="text-success ml-3 mr-2">Sold: {{product.generatedInterest}}</p>
            </div>
            <div class="align-self-end">
              <p [ngClass]="needClass">{{needthresholdtext}} </p>
            </div>
          </div>
          {{ product ? product.description : 'loading' }}
        </ng-template>
      </div>
    </div>
  </div>
</div>
